<html>
    <head>
        <title>Content-type detector</title>
        <meta charset="UTF-8">
        <style>
            #_console p{
                font-weight: 700;
            }
        </style>
    </head>
    <body>
        <h1>Content-type text/html detector</h1>
        <form id=form method="POST">
            <input name="url" placeholder="url"/>
            <input name="mime" value="text/html" placeholder="text/html"/>
            <button>check</button>
        </form>

        <div id='_console'></div>

        <script>
            form.onsubmit = function(e){
                e.preventDefault();

                let url = form.url.value.trim();
                let mime = form.mime.value.trim();

                var x = document.createElement('iframe');
                x.src = `data:text/html,\
                <object id=obj type="${mime}" data="${url}" typemustmatch><script>onload = ()=>top.postMessage(JSON.stringify({u:"${url}", h:obj.clientHeight, m:"${mime}"}), '*');%3c/script></object>
                `;
                x.onload = function(){
                    x.remove();
                }
                document.body.appendChild(x);
            }

            onmessage = e=>{
                let data = JSON.parse(e.data);
                _console.innerHTML += `<p style="color:${data.h? 'green': 'red'}">Resource '${data.u}' ${data.h? 'has': 'has no'} ${data.m} MIME type.</span>`;
            };
        </script>
    </body>
    

</html>
